<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è€ƒç ”å•è¯ - å•è¯æœç´¢</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <!-- å¼•å…¥ Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
  <section id="search-section" class="page-section">
    <div class="nav-bar">
      <a href="{{ url_for('index') }}" class="nav-btn"><i class="fas fa-arrow-left"></i> è¿”å›é¦–é¡µ</a>
    </div>
    <h2>å•è¯æœç´¢</h2>
    <div class="search-box">
      <input type="text" id="search-input" placeholder="è¯·è¾“å…¥å•è¯å…³é”®å­—">
      <button onclick="doSearch()" class="search-btn">æœç´¢</button>
    </div>
    <div id="search-result" class="search-result"></div>
  </section>
  
  <script>
    async function doSearch() {
      const query = document.getElementById('search-input').value.trim();
      if (!query) return;
      const res = await fetch(`/search_word?query=${encodeURIComponent(query)}`);
      const data = await res.json();
      const resultDiv = document.getElementById('search-result');
      if (data.result) {
        const word = data.result;
        resultDiv.innerHTML = `
          <div class="word-detail-card">
            <h2>${word.head_word}</h2>
            <p>
              ç¾éŸ³: /${word.usphone}/ 
              <button class="pronounce-btn" onclick="playPronunciation('${word.head_word}',0,event)">ğŸ”Š</button>
            </p>
            <p>
              è‹±éŸ³: /${word.ukphone}/ 
              <button class="pronounce-btn" onclick="playPronunciation('${word.head_word}',1,event)">ğŸ”Š</button>
            </p>
            <div class="detail-section">
              <h3>é‡Šä¹‰</h3>
              ${word.translations && word.translations.length ? word.translations.map(trans => `
                <div class="translation">
                  <span class="pos">[${trans.pos || ''}]</span>
                  ${trans.tranCn || ''}
                  ${trans.descCn ? `<div class="desc">${trans.descCn}</div>` : ''}
                </div>
              `).join('') : '<p>æš‚æ— é‡Šä¹‰</p>'}
            </div>
            <div class="detail-section">
              <h3>ä¾‹å¥</h3>
              ${word.sentences && word.sentences.length ? word.sentences.map(sen => `
                <div class="sentence">
                  <p class="en">${sen.content}</p>
                  <p class="cn">${sen.cn}</p>
                </div>
              `).join('') : '<p>æš‚æ— ä¾‹å¥</p>'}
            </div>
            <div class="detail-section">
              <h3>çŸ­è¯­</h3>
              ${word.phrases && word.phrases.length ? word.phrases.map(ph => `
                <div class="phrase">
                  <p class="phrase-en">${ph.content}</p>
                  <p class="phrase-cn">${ph.cn}</p>
                </div>
              `).join('') : '<p>æš‚æ— çŸ­è¯­</p>'}
            </div>
          </div>
        `;
      } else {
        resultDiv.innerHTML = `<p>æœªæ‰¾åˆ°åŒ¹é…å•è¯</p>`;
      }
    }
    
    // å‘éŸ³è°ƒç”¨æœ‰é“æ¥å£
    function playPronunciation(word, type, event) {
      event.stopPropagation();
      const audioUrl = `http://dict.youdao.com/dictvoice?type=${type}&audio=${encodeURIComponent(word)}`;
      const audio = new Audio(audioUrl);
      audio.play();
    }
  </script>
</body>
</html>
